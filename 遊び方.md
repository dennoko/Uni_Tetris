# Uni Blocks 遊び方ガイド

開発中やビルド待ちの“ちょっとした時間”に遊べる Unity エディター用パズルゲームです。ここではプレイヤー向けにルール・操作方法・キー変更方法をまとめます。

---
## 1. 目的
落ちてくるピースを積んで横一列をそろえて消去し、ハイスコアを目指します。ゲームオーバーになるまでのスコアが保存されます（EditorPrefs）。

---
## 2. フィールド
- サイズ: 幅 12 × 高さ 25
- ライン: 1列すべて埋まると消える。複数同時消去で高得点。
- ゴースト: ピースが最終的に落ちる位置を半透明表示。
- ホールド: 1手に1回、現在ピースを保管し次ピースと交換可能。

---
## 3. ピース一覧（全11種類）
| 種類 | 名前 | 形の特徴 |
|------|------|----------|
| L3 | 3マスL | 小さいL字 |
| P5 | 凸型P | 2×3の塊 +1列 |
| P5_Mirror | 凸型P鏡像 | P5の左右反転 |
| J4 | 4マスJ | 横4 + 縦1端 |
| L4 | 4マスL | J4の反転 |
| T4 | 4マスT | 3 + 中心支柱 |
| I5 | 5マス直線 | 長い棒 |
| T5 | 5マスT | 縦に伸びたT |
| U5 | 5マスU | 両端 + 下ライン |
| W5 | 5マスW | ジグザグ形 |
| X5 | 5マス十字 | 中心 + 四方向 |

---
## 4. スコア
| 条件 | 得点 (×レベル) |
|------|----------------|
| 1ライン消去 | 100 |
| 2ライン消去 | 300 |
| 3ライン消去 | 500 |
| 4ライン消去 | 800 |
| ハードドロップ | 落下距離 × 2 |

レベル: 合計消去ライン数 ÷ 10 + 1（レベルが上がると事実上スコア倍率が上がります）

落下速度: スコアが上がるほど速くなり、最低 100ms 間隔まで短縮。

---
## 5. 操作（デフォルト）
| アクション | キー | 説明 |
|------------|------|------|
| 左へ移動 | LeftArrow | 1マス左に動かす |
| 右へ移動 | RightArrow | 1マス右に動かす |
| ソフトドロップ | DownArrow | 1マス落下（スコアなし） |
| 回転 | UpArrow | 右回転（失敗時は壁蹴り） |
| ハードドロップ | Space | 一気に最下段へ（距離×2点） |
| ホールド | C | ピース保存/交換（1度置くまで再使用不可） |
| 一時停止 | P | ポーズ表示切替 |
| リスタート | R | ゲーム初期化 |

フォーカスを失う（他ウィンドウ操作など）と自動で一時停止します。

---
## 6. 遊び方の流れ
1. メニュー `Window > Uni Blocks` を開く
2. ウィンドウをクリックしてフォーカスを確保
3. キー操作でピースを動かしラインを消す
4. スコアを伸ばしハイスコア更新を目指す
5. GAME OVER でハイスコアが保存

---
## 7. キー設定の変更
`Assets/Editor/Uni_Blocks/config.json` を編集するとキーを差し替えできます。

### サンプル
```json
{
  "keyBindings": {
    "moveLeft": "A",
    "moveRight": "D",
    "softDrop": "S",
    "rotate": "W",
    "hardDrop": "Space",
    "hold": "LeftShift",
    "pause": "Escape",
    "restart": "R"
  }
}
```

変更手順:
1. JSONを保存
2. Uni Blocks ウィンドウを閉じて再度開く（再読込）

利用できるキー名は Unity の `KeyCode` 列挙体に準拠します。詳しくは公式ドキュメント参照。

---
## 8. ハイスコアのリセット
ハイスコアは自動保存されます。不要になったら次のいずれかの方法で削除できます。

### メニューから削除（推奨）
`Window > Uni Blocks > Reset High Score` を選択 → 確認ダイアログで「削除」。

### スクリプトから削除
```csharp
UnityEditor.EditorPrefs.DeleteKey("UniBlocks_HighScore");
```

削除後、`Uni Blocks` ウィンドウが開いていれば表示が自動更新されます。

---
## 9. よくある質問 (FAQ)
**Q. キー入力が反応しない**  
A. ウィンドウがフォーカスされているか確認し、必要なら再度クリックしてください。

**Q. 設定が反映されない**  
A. JSON構文エラーがないか確認し、ウィンドウを開き直してください。

**Q. ピースが妙な所で止まる**  
A. ゴースト位置と盤面衝突を確認。端回転は壁蹴りを数回試行した後に失敗します。

